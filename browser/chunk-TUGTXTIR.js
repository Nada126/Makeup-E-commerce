import{h as V}from"./chunk-XY3WWHO7.js";import{a as j,c as z,f as N,k as F,l as Y,m as U,p as A}from"./chunk-PYLQ3OY2.js";import{$ as m,$a as n,$b as R,Fa as y,Ja as x,_ as f,_a as p,a as P,ab as r,ac as T,b as O,bb as _,bc as D,fc as E,hb as b,jb as g,kc as I,lb as l,sb as S,tb as o,ua as s,ub as w,vb as u,xb as v,yb as h,za as k,zb as C}from"./chunk-5RLXOBV6.js";function B(c,t){if(c&1){let e=b();n(0,"button",21),g("click",function(){f(e);let a=l(2);return m(a.message="")}),o(1,"\xD7"),r()}}function $(c,t){if(c&1&&(n(0,"div",19),o(1),x(2,B,2,0,"button",20),r()),c&2){let e=l();p("ngClass",e.messageType),s(),u(" ",e.message," "),s(),p("ngIf",e.message)}}function H(c,t){c&1&&(n(0,"div",22)(1,"p"),o(2,"\u{1F389} No reviews found matching your criteria."),r()())}function q(c,t){c&1&&(n(0,"span",41),o(1,"\u2B50"),r())}function G(c,t){if(c&1){let e=b();n(0,"button",42),g("click",function(){f(e);let a=l().$implicit,d=l();return m(d.updateReviewStatus(a.id,"approved"))}),o(1," \u2705 Approve "),r()}}function J(c,t){if(c&1){let e=b();n(0,"button",43),g("click",function(){f(e);let a=l().$implicit,d=l();return m(d.updateReviewStatus(a.id,"rejected"))}),o(1," \u274C Reject "),r()}}function K(c,t){if(c&1){let e=b();n(0,"div",23)(1,"div",24)(2,"div",25)(3,"span",26),o(4),r(),n(5,"div",27),x(6,q,2,0,"span",28),n(7,"span",29),o(8),r()()(),n(9,"div",30)(10,"span",31),o(11),r(),n(12,"span"),o(13),r()()(),n(14,"div",32)(15,"p",33),o(16),r(),n(17,"div",34)(18,"strong"),o(19,"\u{1F4E6} Product:"),r(),n(20,"span"),o(21),r(),n(22,"small",35),o(23),r()()(),n(24,"div",36)(25,"div",37),x(26,G,2,0,"button",38)(27,J,2,0,"button",39),n(28,"button",40),g("click",function(){let a=f(e).$implicit,d=l();return m(d.confirmDelete(a))}),o(29," \u{1F5D1} Delete "),r()()()()}if(c&2){let e=t.$implicit,i=l();s(4),w(e.userName),s(2),p("ngForOf",i.getStars(e.rating)),s(2),u("(",e.rating,"/5)"),s(3),w(e.date),s(),S("status-badge "+i.getStatusBadgeClass(e.status||"pending")),s(),u(" ",e.status||"pending"," "),s(3),u('"',e.comment,'"'),s(5),w(e.productName),s(2),u(" \u2014 ID: ",e.productId),s(3),p("ngIf",(e.status||"pending")!=="approved"),s(),p("ngIf",(e.status||"pending")!=="rejected")}}function Q(c,t){if(c&1){let e=b();n(0,"div",44),g("click",function(){f(e);let a=l();return m(a.cancelDelete())}),n(1,"div",45),g("click",function(a){return f(e),m(a.stopPropagation())}),n(2,"div",46),_(3,"i",47),n(4,"h3"),o(5,"Delete Review"),r()(),n(6,"div",48)(7,"p"),o(8,"Are you sure you want to delete this review by "),n(9,"strong"),o(10),r(),o(11,"?"),r(),n(12,"p",49),o(13,"This action cannot be undone."),r()(),n(14,"div",50)(15,"button",51),g("click",function(){f(e);let a=l();return m(a.cancelDelete())}),_(16,"i",52),o(17," Cancel "),r(),n(18,"button",53),g("click",function(){f(e);let a=l();return m(a.deleteConfirmed())}),_(19,"i",54),o(20," Delete Review "),r()()()()}if(c&2){let e=l();s(10),u('"',e.reviewToDelete==null?null:e.reviewToDelete.userName,'"')}}var L=class c{constructor(t){this.http=t}reviews=[];filteredReviews=[];selectedStatus="all";searchTerm="";message="";messageType="info";confirmVisible=!1;reviewToDelete=null;get totalReviews(){return this.reviews.length}get pendingReviewsCount(){return this.reviews.filter(t=>t.status==="pending").length}baseUrl="http://localhost:3001/reviews";productsUrl="http://localhost:3001/products";ngOnInit(){this.loadReviews()}loadReviews(){this.http.get(this.baseUrl).subscribe({next:t=>{this.http.get(this.productsUrl).subscribe({next:e=>{this.http.get("/data.json").subscribe({next:i=>{let a=[...e,...i];this.reviews=t.map(d=>{let M=a.find(W=>String(W.id)===String(d.productId));return O(P({},d),{productName:M?.name||"Unknown Product",productCode:M?.id||"N/A"})}),this.filterReviews()},error:i=>{console.error("Error loading /data.json:",i),this.reviews=t,this.filterReviews()}})},error:e=>{console.error("Error loading products from db.json:",e),this.reviews=t,this.filterReviews()}})},error:t=>{console.error("Error loading reviews:",t),this.showMessage("\u274C Failed to load reviews.","error")}})}filterReviews(){this.filteredReviews=this.reviews.filter(t=>{let e=this.selectedStatus==="all"||t.status===this.selectedStatus,i=!this.searchTerm||t.userName.toLowerCase().includes(this.searchTerm.toLowerCase())||t.comment.toLowerCase().includes(this.searchTerm.toLowerCase())||t.productName&&t.productName.toLowerCase().includes(this.searchTerm.toLowerCase());return e&&i})}updateReviewStatus(t,e){let i=this.reviews.find(a=>a.id===t);i&&(i.status=e,this.http.patch(`${this.baseUrl}/${t}`,{status:e}).subscribe({next:()=>{this.filterReviews(),this.showMessage("\u2705 Review status updated successfully!","success")},error:a=>{console.error("Error updating review:",a),this.showMessage("\u274C Failed to update review status.","error")}}))}confirmDelete(t){this.reviewToDelete=t,this.confirmVisible=!0}cancelDelete(){this.confirmVisible=!1,this.reviewToDelete=null}deleteConfirmed(){if(!this.reviewToDelete)return;let t=this.reviewToDelete.id;this.http.delete(`${this.baseUrl}/${t}`).subscribe({next:()=>{this.reviews=this.reviews.filter(e=>e.id!==t),this.filterReviews(),this.showMessage("\u2705 Review deleted successfully!","success")},error:e=>{console.error("Error deleting review:",e),this.showMessage("\u274C Failed to delete review.","error")},complete:()=>{this.confirmVisible=!1,this.reviewToDelete=null}})}getStatusBadgeClass(t){switch(t){case"approved":return"status-approved";case"pending":return"status-pending";case"rejected":return"status-rejected";default:return"status-pending"}}getStars(t){return Array(t).fill(0)}showMessage(t,e="info"){this.message=t,this.messageType=e,setTimeout(()=>this.message="",3e3)}static \u0275fac=function(e){return new(e||c)(k(I))};static \u0275cmp=y({type:c,selectors:[["app-manage-reviews"]],decls:26,vars:8,consts:[[1,"admin-reviews-container"],[1,"controls-section"],[1,"search-box"],["type","text","placeholder","Search reviews by user, product, or comment...",1,"search-input",3,"ngModelChange","ngModel"],[1,"search-icon"],[1,"filter-controls"],[1,"status-filter",3,"ngModelChange","ngModel"],["value","all"],["value","pending"],["value","approved"],["value","rejected"],[1,"stats"],[1,"stat-total"],[1,"stat-pending"],["class","message-box",3,"ngClass",4,"ngIf"],[1,"reviews-list"],["class","no-reviews",4,"ngIf"],["class","review-card",4,"ngFor","ngForOf"],["class","modal-overlay",3,"click",4,"ngIf"],[1,"message-box",3,"ngClass"],["class","close-msg",3,"click",4,"ngIf"],[1,"close-msg",3,"click"],[1,"no-reviews"],[1,"review-card"],[1,"review-header"],[1,"reviewer-info"],[1,"user-name"],[1,"rating"],["class","star",4,"ngFor","ngForOf"],[1,"rating-text"],[1,"review-meta"],[1,"review-date"],[1,"review-content"],[1,"review-comment"],[1,"product-info"],[1,"product-id"],[1,"review-actions"],[1,"action-buttons"],["class","btn-approve",3,"click",4,"ngIf"],["class","btn-reject",3,"click",4,"ngIf"],[1,"btn-delete",3,"click"],[1,"star"],[1,"btn-approve",3,"click"],[1,"btn-reject",3,"click"],[1,"modal-overlay",3,"click"],[1,"modern-modal",3,"click"],[1,"modal-header"],[1,"bi","bi-exclamation-triangle","warning-icon"],[1,"modal-body"],[1,"warning-text"],[1,"modal-actions"],[1,"btn-secondary",3,"click"],[1,"bi","bi-x-lg"],[1,"btn-danger",3,"click"],[1,"bi","bi-trash"]],template:function(e,i){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"input",3),C("ngModelChange",function(d){return h(i.searchTerm,d)||(i.searchTerm=d),d}),g("ngModelChange",function(){return i.filterReviews()}),r(),n(4,"span",4),o(5,"\u{1F50D}"),r()(),n(6,"div",5)(7,"select",6),C("ngModelChange",function(d){return h(i.selectedStatus,d)||(i.selectedStatus=d),d}),g("ngModelChange",function(){return i.filterReviews()}),n(8,"option",7),o(9,"All Status"),r(),n(10,"option",8),o(11,"Pending"),r(),n(12,"option",9),o(13,"Approved"),r(),n(14,"option",10),o(15,"Rejected"),r()(),n(16,"div",11)(17,"span",12),o(18),r(),n(19,"span",13),o(20),r()()()(),x(21,$,3,3,"div",14),n(22,"div",15),x(23,H,3,0,"div",16)(24,K,30,12,"div",17),r(),x(25,Q,21,1,"div",18),r()),e&2&&(s(3),v("ngModel",i.searchTerm),s(4),v("ngModel",i.selectedStatus),s(11),u("Total: ",i.totalReviews),s(2),u("Pending: ",i.pendingReviewsCount),s(),p("ngIf",i.message),s(2),p("ngIf",i.filteredReviews.length===0),s(),p("ngForOf",i.filteredReviews),s(),p("ngIf",i.confirmVisible))},dependencies:[E,R,T,D,V,A,Y,U,j,F,z,N],styles:['.admin-reviews-container[_ngcontent-%COMP%]{min-height:100vh;background:linear-gradient(135deg,#f5f7fa,#f8f9fa);padding-bottom:2rem}.reviews-header[_ngcontent-%COMP%]{background:linear-gradient(90deg,#ffc1cc,#ffb6b9,#fad0c4);padding:2.5rem 0;box-shadow:0 4px 20px #ffb6c14d;margin-bottom:2rem;position:relative;overflow:hidden}.reviews-header[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background:linear-gradient(45deg,rgba(255,255,255,.1) 0%,transparent 50%);pointer-events:none}.header-content[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:0 2rem;display:flex;justify-content:space-between;align-items:center;position:relative;z-index:2}.header-title[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2.5rem;font-weight:700;margin:0 0 .5rem;background:linear-gradient(135deg,#4a4a4a,#6c757d);-webkit-background-clip:text;-webkit-text-fill-color:transparent;text-shadow:0 2px 4px rgba(255,255,255,.8)}.header-title[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#6c757d;margin:0;font-size:1.1rem;font-weight:500}.back-btn[_ngcontent-%COMP%]{background:#fffffff2;color:#4a4a4a;padding:.75rem 1.5rem;border-radius:25px;text-decoration:none;font-weight:600;border:2px solid transparent;transition:all .3s ease;box-shadow:0 4px 15px #ff6f9133;-webkit-backdrop-filter:blur(10px);backdrop-filter:blur(10px)}.back-btn[_ngcontent-%COMP%]:hover{background:#fff;border-color:#ff6f91;transform:translateY(-2px);box-shadow:0 6px 20px #ff6f9166}.controls-section[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto 2rem;padding:1.5rem 2rem;display:flex;justify-content:space-between;align-items:center;gap:2rem;background:#fff;border-radius:20px;border:1px solid rgba(255,182,193,.2);box-shadow:0 4px 20px #00000014}.search-box[_ngcontent-%COMP%]{position:relative;flex:1;max-width:400px}.search-input[_ngcontent-%COMP%]{width:100%;padding:1rem 1rem 1rem 3rem;border:2px solid #f1f3f4;border-radius:15px;background:#f8f9fa;font-size:1rem;font-weight:500;transition:all .3s ease}.search-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#ffb6b9;background:#fff;box-shadow:0 0 0 4px #ffb6b91a;transform:translateY(-1px)}.search-icon[_ngcontent-%COMP%]{position:absolute;left:1rem;top:50%;transform:translateY(-50%);color:#ff6f91;font-size:1.1rem}.filter-controls[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1.5rem}.status-filter[_ngcontent-%COMP%]{padding:1rem 1.5rem;border:2px solid #f1f3f4;border-radius:12px;background:#f8f9fa;font-size:1rem;font-weight:500;cursor:pointer;min-width:150px;transition:all .3s ease}.status-filter[_ngcontent-%COMP%]:focus{outline:none;border-color:#ffb6b9;background:#fff;box-shadow:0 0 0 3px #ffb6b91a}.stats[_ngcontent-%COMP%]{display:flex;gap:1rem;font-size:.95rem}.stat-total[_ngcontent-%COMP%], .stat-pending[_ngcontent-%COMP%]{padding:.75rem 1.25rem;border-radius:15px;font-weight:600;border:1px solid rgba(0,0,0,.05);box-shadow:0 2px 8px #0000001a}.stat-total[_ngcontent-%COMP%]{color:#4a4a4a;background:linear-gradient(135deg,#f8f9fa,#e9ecef)}.stat-pending[_ngcontent-%COMP%]{color:#ff6f91;background:linear-gradient(135deg,#fff5f7,#ffeef1);border:1px solid rgba(255,111,145,.3)}.reviews-list[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:0 2rem;display:flex;flex-direction:column;gap:1.5rem}.no-reviews[_ngcontent-%COMP%]{text-align:center;padding:4rem 2rem;color:#6c757d;background:#fff;border-radius:20px;border:2px dashed #e9ecef;box-shadow:0 4px 20px #0000000d}.review-card[_ngcontent-%COMP%]{background:#fff;border-radius:20px;padding:2rem;border:1px solid rgba(255,182,193,.1);box-shadow:0 4px 25px #00000014;position:relative;overflow:hidden;transition:all .3s ease;animation:_ngcontent-%COMP%_slideIn .5s ease-out}.review-card[_ngcontent-%COMP%]:before{content:"";position:absolute;left:0;top:0;width:4px;height:100%;background:linear-gradient(180deg,#ffc1cc,#ffb6b9,#fad0c4);transition:width .3s ease}.review-card[_ngcontent-%COMP%]:hover{transform:translateY(-5px);box-shadow:0 8px 35px #ffb6c133}.review-card[_ngcontent-%COMP%]:hover:before{width:6px}.review-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:1.5rem;padding-left:1rem}.reviewer-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem;flex:1}.user-name[_ngcontent-%COMP%]{font-weight:700;color:#2d3748;font-size:1.2rem;display:flex;align-items:center;gap:.5rem}.user-name[_ngcontent-%COMP%]:before{content:"\\1f464"}.rating[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.star[_ngcontent-%COMP%]{font-size:1.2rem;filter:drop-shadow(0 2px 4px rgba(255,193,7,.3))}.review-meta[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-end;gap:.75rem;min-width:150px}.review-date[_ngcontent-%COMP%]{color:#6c757d;font-size:.9rem;font-weight:500;background:#f8f9fa;padding:.4rem .8rem;border-radius:10px}.status-badge[_ngcontent-%COMP%]{padding:.5rem 1rem;border-radius:15px;font-size:.85rem;font-weight:700;text-transform:uppercase;letter-spacing:.5px;box-shadow:0 2px 8px #0000001a}.status-approved[_ngcontent-%COMP%]{background:linear-gradient(135deg,#d4edda,#c3e6cb);color:#155724}.status-pending[_ngcontent-%COMP%]{background:linear-gradient(135deg,#fff3cd,#ffeaa7);color:#856404}.status-rejected[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f8d7da,#f5c6cb);color:#721c24}.review-content[_ngcontent-%COMP%]{margin-bottom:2rem;padding-left:1rem}.review-comment[_ngcontent-%COMP%]{color:#4a5568;background:#f8f9fa;padding:1.5rem;border-radius:15px;border-left:4px solid #ffb6b9;line-height:1.7;font-size:1.05rem;font-weight:500}.product-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:1rem 1.5rem;background:linear-gradient(135deg,#fff5f7,#ffeef1);border-radius:15px;border:1px solid rgba(255,182,193,.3);font-weight:600}.product-info[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#ff6f91;font-size:.95rem}.product-info[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#4a4a4a;font-size:1rem}.review-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;padding-left:1rem}.action-buttons[_ngcontent-%COMP%]{display:flex;gap:1rem}.action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.75rem 1.5rem;border:none;border-radius:12px;font-size:.9rem;font-weight:700;cursor:pointer;transition:all .3s ease;box-shadow:0 2px 10px #0000001a;text-transform:uppercase;letter-spacing:.5px;min-width:120px}.btn-approve[_ngcontent-%COMP%]{background:linear-gradient(135deg,#d4edda,#c3e6cb);color:#155724}.btn-approve[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#c3e6cb,#b1dfbb);transform:translateY(-2px)}.btn-reject[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f8d7da,#f5c6cb);color:#721c24}.btn-reject[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#f5c6cb,#f1b0b7);transform:translateY(-2px)}.btn-delete[_ngcontent-%COMP%]{background:linear-gradient(135deg,#f8f9fa,#e9ecef);color:#6c757d}.btn-delete[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#e9ecef,#dee2e6);transform:translateY(-2px)}.message-box[_ngcontent-%COMP%]{max-width:600px;margin:10px auto 20px;padding:10px 16px;border-radius:8px;text-align:center;font-weight:500;position:relative;animation:_ngcontent-%COMP%_fadeIn .3s ease-in-out}.message-box.info[_ngcontent-%COMP%]{background-color:#e7f3fe;color:#3178c6;border:1px solid #b3d4fc}.message-box.success[_ngcontent-%COMP%]{background-color:#d4edda;color:#155724;border:1px solid #c3e6cb}.message-box.error[_ngcontent-%COMP%]{background-color:#f8d7da;color:#721c24;border:1px solid #f5c6cb}.close-msg[_ngcontent-%COMP%]{position:absolute;right:10px;top:6px;border:none;background:transparent;color:inherit;font-size:1.2rem;cursor:pointer}.modal-overlay[_ngcontent-%COMP%]{position:fixed;top:0;left:0;width:100%;height:100%;background:#00000080;-webkit-backdrop-filter:blur(8px);backdrop-filter:blur(8px);display:flex;justify-content:center;align-items:center;z-index:1000;animation:_ngcontent-%COMP%_fadeIn .3s ease}.modern-modal[_ngcontent-%COMP%]{background:#fff;border-radius:20px;padding:30px;max-width:450px;width:90%;box-shadow:0 20px 60px #ff69874d;animation:_ngcontent-%COMP%_slideUp .3s ease;border:1px solid rgba(255,105,135,.1)}.modal-header[_ngcontent-%COMP%]{text-align:center;margin-bottom:20px}.warning-icon[_ngcontent-%COMP%]{font-size:3rem;color:#ff6f91;margin-bottom:15px;display:block}.modal-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{color:#333;font-weight:600;margin:0}.modal-body[_ngcontent-%COMP%]{text-align:center;margin-bottom:25px}.modal-body[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:10px 0;color:#555;line-height:1.5}.warning-text[_ngcontent-%COMP%]{color:#ff6f91!important;font-weight:500;font-size:.9rem}.modal-actions[_ngcontent-%COMP%]{display:flex;gap:12px;justify-content:center}.btn-secondary[_ngcontent-%COMP%]{background:linear-gradient(45deg,#6c757d,#9fa4a8);color:#fff;border:none;padding:12px 24px;border-radius:12px;font-weight:500;cursor:pointer;transition:all .3s ease;display:flex;align-items:center;gap:8px;box-shadow:0 3px 8px #6c757d40}.btn-danger[_ngcontent-%COMP%]{background:linear-gradient(45deg,#ff6f91,#ff9a9e);color:#fff;border:none;padding:12px 24px;border-radius:12px;font-weight:500;cursor:pointer;transition:all .3s ease;display:flex;align-items:center;gap:8px;box-shadow:0 3px 8px #ff698740}.btn-secondary[_ngcontent-%COMP%]:hover{background:linear-gradient(45deg,#5a6268,#868e96);transform:translateY(-2px);box-shadow:0 5px 12px #6c757d59}.btn-danger[_ngcontent-%COMP%]:hover{background:linear-gradient(45deg,#e04878,#ff6f91);transform:translateY(-2px);box-shadow:0 5px 12px #ff698759}@keyframes _ngcontent-%COMP%_slideUp{0%{opacity:0;transform:translateY(30px) scale(.9)}to{opacity:1;transform:translateY(0) scale(1)}}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}@media (max-width: 768px){.header-content[_ngcontent-%COMP%]{flex-direction:column;gap:1.5rem;text-align:center}.controls-section[_ngcontent-%COMP%]{flex-direction:column;gap:1.5rem}.filter-controls[_ngcontent-%COMP%]{flex-wrap:wrap;justify-content:space-between;width:100%}.review-header[_ngcontent-%COMP%]{flex-direction:column;gap:1.5rem}.review-meta[_ngcontent-%COMP%]{align-items:flex-start}.review-actions[_ngcontent-%COMP%]{justify-content:center}.action-buttons[_ngcontent-%COMP%]{flex-wrap:wrap;justify-content:center}.action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1;min-width:100px}}@keyframes _ngcontent-%COMP%_slideIn{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}']})};export{L as ManageReviews};
